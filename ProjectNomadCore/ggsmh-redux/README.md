Based on [GGSMH repo](https://github.com/HKhaan/GGSMH).
Taken from [commit 04ea2a9](https://github.com/HKhaan/GGSMH/commit/04ea2a9db35726554a1fe17f4f787eac56e3a057) and 
rewritten thereafter.